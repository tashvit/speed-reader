// ==UserScript==
// @name         speed reader
// @namespace    http://tampermonkey.net/
// @version      0.1
// @description  try to take over the world!
// @author       tashvit
// @match        *://*/*
// @icon         https://www.google.com/s2/favicons?domain=stackoverflow.com
// @grant        none
// ==/UserScript==

(function(){function t(){var a=document.createElement("button");a.innerHTML="Speed Read";a.style.backgroundColor="yellow";a.style.color="red";a.style.borderColor="red";a.style.borderWidth="2px";a.style.cursor="pointer";a.style.borderRadius="20px";a.style.padding="10px 10px 10px 10px";a.style.position="sticky";a.style.top="0";a.style.zIndex="9999999999999999999999999";if(!document.querySelector(".overlay")){u();v();var b=document.querySelector(".reader-wrapper");document.querySelector(".overlay").style.display=
"none";b.style.display="none"}document.getElementsByTagName("body")[0].prepend(a);a.addEventListener("click",function(){q()})}function q(){if(""==window.getSelection().toString())return!1;var a=document.querySelector(".overlay"),b=document.querySelector(".reader-wrapper");a.style.display="none";b.style.display="none";if("none"===a.style.display&&"none"===b.style.display)if(a.style.display="block",b.style.display="flex",""!==window.getSelection().toString())m=!0,w(0);else return!1;else a.style.display=
"none",b.style.display="none",m=!1,a=document.querySelector("span.left-half"),b=document.querySelector("span.right-half"),document.querySelector("span.pivot").innerHTML="",a.innerHTML="",b.innerHTML=""}function w(){function a(b){function c(f){var h=f.replace(/[?.,!:;*-]+$/,"");switch(!0){case 4>h.length:d(f,0);break;case 8>h.length:d(f,1);break;case 12>h.length:d(f,2);break;case 14>h.length:d(f,3)}}function d(f,h){var n=f.replace(/[?.,!:;*-]+$/,""),k=f.split(""),l=Math.floor(n.length/2-h);n=k[l];
var x=k.slice(0,l);k=k.slice(l+1,k.length);l=document.querySelector("span.pivot");var p=document.querySelector("span.left-half"),r=document.querySelector("span.right-half");l.innerHTML="";p.innerHTML="";r.innerHTML="";l.innerHTML=n;p.innerHTML=x.join("");r.innerHTML=k.join("");document.querySelector("div.word").style.left=110-p.offsetWidth-10+"px"}var g=6E4/350,e=("[starting]. [starting].. [starting]... [starting]...."+window.getSelection()).toString().split(/\r\n|\r|\n|\s/g);if(b<e.length&&m)e[b].replace(/[?.,!:;*-]+$/,
"")!==e[b]?b===e.length-1?setTimeout(function(){a(b)},120):setTimeout(function(){a(b)},g):setTimeout(function(){a(b)},120),c(e[b]),b++;else return!1}a(0)}function v(){var a=document.createElement("DIV");document.body.appendChild(a);a.className="reader-wrapper";a=document.querySelector(".reader-wrapper");a.style.zIndex="999999";a.style.position="fixed";a.style.display="flex";a.style.flexDirection="row";a.style.top="50%";a.style.left="50%";a.style.transform="translate(-50%, -50%)";(function(){var b=
document.createElement("DIV");document.querySelector("div.reader-wrapper").appendChild(b);b.className="word-box";b=document.querySelector(".word-box");b.style.width="400px";b.style.height="100px";b.style.backgroundColor="rgb(48, 48, 48)";b.style.position="relative";(function(){var c=document.createElement("DIV");document.querySelector("div.word-box").appendChild(c);c.className="reticle";c=document.querySelector("div.reticle");c.style.position="absolute";c.style.width="10px";c.style.height="100px";
c.style.left="110px";c.style.borderTop="20px solid rgb(101, 101, 101)";c.style.borderBottom="20px solid rgb(101, 101, 101)";c.style.boxSizing="border-box"})();(function(){var c=document.createElement("DIV");document.querySelector("div.word-box").appendChild(c);c.className="word";c=document.querySelector("div.word");c.style.left="0px";c.style.position="absolute";c.style.top="50%";c.style.transform="translateY(-50%)";(function(){var d=document.createElement("SPAN");document.querySelector("div.word").appendChild(d);
d.className="pivot";d=document.querySelector("span.pivot");d.style.color="rgb(115, 181, 238)";d.style.fontSize="50px";d.style.fontFamily="monospace"})();(function(){var d=document.createElement("SPAN"),g=document.createElement("SPAN"),e=document.querySelector("div.word");e.insertBefore(d,e.childNodes[0]);e.appendChild(g);d.className="left-half";g.className="right-half";d=document.querySelector("span.left-half");g=document.querySelector("span.right-half");d.style.color="rgb(224, 224, 224)";d.style.fontSize=
"50px";d.style.fontFamily="monospace";g.style.color="rgb(224, 224, 224)";g.style.fontSize="50px";g.style.fontFamily="monospace"})()})()})();(function(){var b=document.createElement("DIV"),c=document.createElement("DIV"),d=document.querySelector("div.reader-wrapper");d.insertBefore(b,d.childNodes[0]);d.appendChild(c);b.className="left";c.className="right";b=document.querySelector("div.left");c=document.querySelector("div.right");b.style.backgroundColor="rgb(64, 64, 64)";b.style.width="40px";b.style.height=
"100px";c.style.backgroundColor="rgb(64, 64, 64)";c.style.width="40px";c.style.height="100px";b.style.borderTopLeftRadius="8px";b.style.borderBottomLeftRadius="8px";c.style.borderTopRightRadius="8px";c.style.borderBottomRightRadius="8px"})()}function u(){var a=document.createElement("DIV");document.body.appendChild(a);a.className="overlay";a=document.querySelector(".overlay");a.style.zIndex="999998";a.style.top="0";a.style.left="0";a.style.width="100%";a.style.height="100%";a.style.position="fixed";
a.style.backgroundColor="rgba(0,0,0,0.86)"}var m=!0;document.addEventListener("keydown",function(a){var b=document.querySelector(".overlay");"Escape"===a.key&&b&&"none"!=b.style.display?(a=document.querySelector(".reader-wrapper"),b.style.display="none",a.style.display="none"):a.ctrlKey&&"["===a.key&&(b?"none"!=b.style.display?(a=document.querySelector(".reader-wrapper"),b.style.display="none",a.style.display="none"):q():t())},!0)})();
